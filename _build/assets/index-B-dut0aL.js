import{j as b,u as v,k as F}from"./client-Cyo2pQ84.js";function q(s,n){let r,a=()=>!r||r.state==="unresolved"?void 0:r.latest;return[r]=b(()=>O(s,v(a)),h=>h,n),()=>r()}class u{static all(){return new u}static allSettled(){return new u}static any(){return new u}static race(){return new u}static reject(){return new u}static resolve(){return new u}catch(){return new u}then(){return new u}finally(){return new u}}function O(s,n){if(!F.context)return s(n);const r=fetch,a=Promise;try{return window.fetch=()=>new u,Promise=u,s(n)}finally{window.fetch=r,Promise=a}}function S(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function I(s){if(s.__esModule)return s;var n=s.default;if(typeof n=="function"){var r=function a(){return this instanceof a?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};r.prototype=n.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(s).forEach(function(a){var h=Object.getOwnPropertyDescriptor(s,a);Object.defineProperty(r,a,h.get?h:{enumerable:!0,get:function(){return s[a]}})}),r}var w={exports:{}},f={exports:{}};const x={},P=Object.freeze(Object.defineProperty({__proto__:null,default:x},Symbol.toStringTag,{value:"Module"})),D=I(P);var m;function R(){if(m)return f.exports;m=1;const s=D,n=async r=>new Promise((a,h)=>{const e=s.request(r,t=>{const i=[];let l=!1;t.on("data",o=>{if(!l&&!String(o).startsWith("/*O_o*/"))return a(null);l=!0,i.push(o)}),t.on("end",()=>{a({ok:!0,text:()=>Buffer.concat(i).toString()})})});e.on("error",h),e.end()});return f.exports=n,f.exports.default=n,f.exports}(function(s){const n=typeof window<"u"&&typeof window.document<"u",r=n?window.fetch:R();class a{constructor(e,t){this.id=e,this.setOption(t)}setOption(e){e?typeof e=="string"?(this.sheetName=e,this.sheetId=this.sheetId||null):typeof e=="object"&&(this.sheetName=e.sheetName||this.sheetName,this.sheetId=e.sheetId||this.sheetId,this.useFormattedDate=e.hasOwnProperty("useFormattedDate")?e.useFormattedDate:this.useFormattedDate,this.useFormat=e.hasOwnProperty("useFormat")?e.useFormat:this.useFormat):(this.sheetName=this.sheetName||null,this.sheetId=this.sheetId||null,this.useFormattedDate=this.useFormattedDate||!1,this.useFormat=this.useFormat||!1)}isDate(e){return e&&typeof e=="string"&&/Date\((\d+),(\d+),(\d+)\)/.test(e)}async getSpreadsheetDataUsingFetch(){if(!this.id)return null;let e=`https://docs.google.com/spreadsheets/d/${this.id}/gviz/tq?`;e+=this.sheetId?`gid=${this.sheetId}`:`sheet=${this.sheetName}`;try{const t=await r(e);return t&&t.ok?t.text():null}catch(t){return console.error("Error fetching spreadsheet data:",t),null}}normalizeRow(e){return e.map(t=>t&&t.v!==null&&t.v!==void 0?t:{})}applyHeaderIntoRows(e,t){return t.map(({c:i})=>this.normalizeRow(i)).map(i=>i.reduce((l,o,c)=>o.v!==null&&o.v!==void 0?Object.assign(l,{[e[c]]:this.useFormat?o.f||o.v:this.useFormattedDate&&this.isDate(o.v)&&o.f||o.v}):l,{}))}getItems(e){let t=[];try{const i=/google\.visualization\.Query\.setResponse\(({.*})\);/,[l,o]=e.match(i),c=JSON.parse(o);if(c.table.cols.some(({label:d})=>!!d)){const d=c.table.cols.map(({label:p})=>p);t=this.applyHeaderIntoRows(d,c.table.rows)}else{const[d,...p]=c.table.rows,g=this.normalizeRow(d.c).map(y=>y.v);t=this.applyHeaderIntoRows(g,p)}}catch(i){console.error("Error parsing spreadsheet data:",i)}return t}async parse(e,t){if(e&&(this.id=e),t&&this.setOption(t),!this.id)throw new Error("SpreadsheetId is required.");const i=await this.getSpreadsheetDataUsingFetch();return i===null?[]:this.getItems(i)}}s.exports=a,s.exports.default=a})(w);var j=w.exports;const _=S(j);export{_ as P,q as c};
